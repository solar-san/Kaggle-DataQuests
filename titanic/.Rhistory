Embarked = as.factor(Embarked)
)
}
train_data_factorized <- factorize_data(dataframe = train_data)
train_data <- data_loader(
"titanic.zip",
"train.csv"
)
testr_data <- data_loader(
"titanic.zip",
"test.csv"
)
train_data <- data_loader(
"titanic.zip",
"train.csv"
)
test_data <- data_loader(
"titanic.zip",
"test.csv"
)
train_data %>% str
train_data_factorized <- factorize_data(dataframe = train_data)
test_data_factorized <- factorize_data(dataframe = test_data)
test_data_factorized %>%
is.na() %>%
sum
train_data_factorized <- train_data_factorized %>%
na.omit()
test_data_factorized <- test_data_factorized %>%
na.omit()
y_hat <- ifelse(
predict(
sel_stepwise,
newdata = test_data_factorized,
type = "response"
) > .5,
1,
0
)
test_data$Survived
test_data %>% str
pROC(sel_stepwise)
knitr::opts_chunk$set(
echo = TRUE
)
library(tidyverse)
library(glmnet)
library(ggthemes)
library(caret)
library(pROC)
theme_set(
theme_tufte(
base_size = 32,
base_family = 'Atkinson Hyperlegible'
)
)
pROC(sel_stepwise)
roc(sel_stepwise)
roc(predictions, test_data_factorized)
predictions <-
ifelse(
predict(
sel_stepwise,
newdata = test_data_factorized,
type = "response"
) > .5,
1,
0
)
roc(predictions, test_data_factorized)
predictions <-
ifelse(
predict(
sel_stepwise,
newdata = test_data_factorized,
type = "response"
) > .5,
1,
0
)
predictions <-
ifelse(
predict(
sel_stepwise,
newdata = test_data_factorized,
type = "response"
) > .7,
1,
0
)
data_loader("gender_submission.csv", "titanic.csv")
data_loader("gender_submission.csv", "titanic.zip")
data_loader("gender_submission.csv", "titanic.zip")
data_loader("gender_submission.csv", "titanic.zip")
data_loader(
"titanic.zip",
"gender_submission.csv"
)
save(
data.frame(
PassengerId = test_data %>%
select(PassengerId),
Survived = predictions
)
save(
data.frame(
PassengerId = test_data %>%
select(PassengerId),
Survived = predictions,
)
)
save(
data.frame(
PassengerId = test_data %>%
select(PassengerId),
Survived = predictions
)
)
submission <- data.frame(
PassengerId = test_data %>%
select(PassengerId),
Survived = predictions
)
knitr::opts_chunk$set(
echo = TRUE
)
library(tidyverse)
library(glmnet)
library(ggthemes)
library(caret)
library(pROC)
theme_set(
theme_tufte(
base_size = 32,
base_family = 'Atkinson Hyperlegible'
)
)
data_loader <- function(filename, dataset, path = "data/") {
path <- paste0(path, filename)
read.csv(
unz(
path,
dataset
)
)
}
train_data <- data_loader(
"titanic.zip",
"train.csv"
)
test_data <- data_loader(
"titanic.zip",
"test.csv"
)
train_data %>% str
factorize_data <- function(dataframe) {
dataframe %>%
select(-Name, -Ticket) %>%
mutate(
Pclass = as.factor(Pclass),
Sex = as.factor(Sex),
SibSp = as.factor(SibSp),
Parch = as.factor(Parch),
Cabin = as.factor(Cabin),
Embarked = as.factor(Embarked)
)
}
train_data_factorized <- factorize_data(dataframe = train_data)
test_data_factorized <- factorize_data(dataframe = test_data)
fit_full <- glm(Survived ~ ., data = train_data_factorized)
fit_full %>% summary
fit_null <- glm(Survived ~ 1, data = train_data_factorized)
sel_stepwise <- step(
fit_full,
scope = c(fit_null, fit_full),
direction = "both",
k = log(dim(train_data_factorized)[1])
)
sel_stepwise
predictions <-
ifelse(
predict(
sel_stepwise,
newdata = test_data_factorized,
type = "response"
) > .7,
1,
0
)
submission <- data.frame(
PassengerId = test_data %>%
select(PassengerId),
Survived = predictions
)
save(
)
save(
submission,
file = "titanic_submission"
)
save(
submission,
file = "titanic_submission.csv"
)
save(
submission,
file = "titanic_submission.csv",
ascii = TRUE
)
save(
submission,
file = "titanic_submission.csv",
ascii = TRUE
)
submission
write.csv(
submission
)
write.csv(
submission,
"data/submission.csv"
)
write.csv(
submission,
"data/"
)
write.csv(
submission,
"data"
)
write.csv(
submission,
"/datadata"
)
write.csv(
submission,
"/data/"
)
write.csv(
submission,
"/data/"
)
write.csv(
submission,
"data/submission"
)
write.csv(
submission,
"data/submission.csv"
)
write.csv(
submission,
"data/submission.csv",
row.names = FALSE
)
knitr::opts_chunk$set(
echo = TRUE
)
library(tidyverse)
library(glmnet)
library(ggthemes)
library(caret)
library(pROC)
theme_set(
theme_tufte(
base_size = 32,
base_family = 'Atkinson Hyperlegible'
)
)
data_loader <- function(filename, dataset, path = "data/") {
path <- paste0(path, filename)
read.csv(
unz(
path,
dataset
)
)
}
train_data <- data_loader(
"titanic.zip",
"train.csv"
)
test_data <- data_loader(
"titanic.zip",
"test.csv"
)
train_data %>% str
factorize_data <- function(dataframe) {
dataframe %>%
select(-Name, -Ticket) %>%
mutate(
Pclass = as.factor(Pclass),
Sex = as.factor(Sex),
SibSp = as.factor(SibSp),
Parch = as.factor(Parch),
Cabin = as.factor(Cabin),
Embarked = as.factor(Embarked)
)
}
train_data_factorized <- factorize_data(dataframe = train_data)
test_data_factorized <- factorize_data(dataframe = test_data)
fit_full <- glm(Survived ~ ., data = train_data_factorized)
fit_full %>% summary
fit_null <- glm(Survived ~ 1, data = train_data_factorized)
sel_stepwise <- step(
fit_full,
scope = c(fit_null, fit_full),
direction = "both",
k = log(dim(train_data_factorized)[1])
)
sel_stepwise
predictions <-
ifelse(
predict(
sel_stepwise,
newdata = test_data_factorized,
type = "response"
) > .5,
1,
0
)
submission <- data.frame(
PassengerId = test_data %>%
select(PassengerId),
Survived = predictions
)
submission
write.csv(
submission,
"data/submission.csv",
row.names = FALSE
)
data_loader(
"titanic.zip",
"gender_submission.csv"
)
predictions <-
ifelse(
predict(
sel_stepwise,
newdata = test_data_factorized,
type = "response"
) > .3,
1,
0
)
knitr::opts_chunk$set(
echo = TRUE
)
library(tidyverse)
library(glmnet)
library(ggthemes)
library(caret)
library(pROC)
theme_set(
theme_tufte(
base_size = 32,
base_family = 'Atkinson Hyperlegible'
)
)
data_loader <- function(filename, dataset, path = "data/") {
path <- paste0(path, filename)
read.csv(
unz(
path,
dataset
)
)
}
train_data <- data_loader(
"titanic.zip",
"train.csv"
)
test_data <- data_loader(
"titanic.zip",
"test.csv"
)
train_data %>% str
factorize_data <- function(dataframe) {
dataframe %>%
select(-Name, -Ticket) %>%
mutate(
Pclass = as.factor(Pclass),
Sex = as.factor(Sex),
SibSp = as.factor(SibSp),
Parch = as.factor(Parch),
Cabin = as.factor(Cabin),
Embarked = as.factor(Embarked)
)
}
train_data_factorized <- factorize_data(dataframe = train_data)
test_data_factorized <- factorize_data(dataframe = test_data)
fit_full <- glm(Survived ~ ., data = train_data_factorized)
fit_full %>% summary
fit_null <- glm(Survived ~ 1, data = train_data_factorized)
sel_stepwise <- step(
fit_full,
scope = c(fit_null, fit_full),
direction = "both",
k = log(dim(train_data_factorized)[1])
)
sel_stepwise
predictions <-
ifelse(
predict(
sel_stepwise,
newdata = test_data_factorized,
type = "response"
) > .3,
1,
0
)
submission <- data.frame(
PassengerId = test_data %>%
select(PassengerId),
Survived = predictions
)
submission
write.csv(
submission,
"data/submission.csv",
row.names = FALSE
)
data_loader(
"titanic.zip",
"gender_submission.csv"
)
train_data %>% summarise()
train_data %>% summary
train_data_factorized %>% summary
knitr::opts_chunk$set(
echo = TRUE
)
library(tidyverse)
library(glmnet)
library(ggthemes)
library(caret)
library(pROC)
theme_set(
theme_tufte(
base_size = 32,
base_family = 'Atkinson Hyperlegible'
)
)
data_loader <- function(filename, dataset, path = "data/") {
path <- paste0(path, filename)
read.csv(
unz(
path,
dataset
)
)
}
train_data <- data_loader(
"titanic.zip",
"train.csv"
)
test_data <- data_loader(
"titanic.zip",
"test.csv"
)
train_data %>% str
factorize_data <- function(dataframe) {
dataframe %>%
select(-Name, -Ticket) %>%
mutate(
Pclass = as.factor(Pclass),
Sex = as.factor(Sex),
SibSp = as.factor(SibSp),
Parch = as.factor(Parch),
Cabin = as.factor(Cabin),
Embarked = as.factor(Embarked)
)
}
train_data_factorized <- factorize_data(dataframe = train_data)
test_data_factorized <- factorize_data(dataframe = test_data)
train_data_factorized %>% summary
fit_full <- glm(Survived ~ ., data = train_data_factorized)
fit_full %>% summary
fit_null <- glm(Survived ~ 1, data = train_data_factorized)
sel_stepwise <- step(
fit_full,
scope = c(fit_null, fit_full),
direction = "both",
k = log(dim(train_data_factorized)[1])
)
sel_stepwise
predictions <-
ifelse(
predict(
sel_stepwise,
newdata = test_data_factorized,
type = "response"
) > .3,
1,
0
)
submission <- data.frame(
PassengerId = test_data %>%
select(PassengerId),
Survived = predictions
)
submission
write.csv(
submission,
"data/submission.csv",
row.names = FALSE
)
data_loader(
"titanic.zip",
"gender_submission.csv"
)
