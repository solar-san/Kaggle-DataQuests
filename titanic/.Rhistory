)
data_loader <- function(filename, dataset, path = "data/") {
path <- paste0(path, filename)
read.csv(
unz(
path,
dataset
)
)
}
train_data <- data_loader(
"titanic.zip",
"train.csv"
)
test_data <- data_loader(
"titanic.zip",
"test.csv"
)
train_data %>% str
factorize_data <- function(dataframe) {
dataframe %>%
select(-Name, -Ticket) %>%
mutate(
Pclass = as.factor(Pclass),
Sex = as.factor(Sex),
SibSp = as.factor(SibSp),
Parch = as.factor(Parch),
Cabin = as.factor(Cabin),
Embarked = as.factor(Embarked)
)
}
train_data_factorized <- factorize_data(dataframe = train_data)
test_data_factorized <- factorize_data(dataframe = test_data)
fit_full <- glm(Survived ~ ., data = train_data_factorized)
fit_full %>% summary
fit_null <- glm(Survived ~ 1, data = train_data_factorized)
sel_stepwise <- step(
fit_full,
scope = c(fit_null, fit_full),
direction = "both",
k = log(dim(train_data_factorized)[1])
)
sel_stepwise
predictions <-
ifelse(
predict(
sel_stepwise,
newdata = test_data_factorized,
type = "response"
) > .3,
1,
0
)
submission <- data.frame(
PassengerId = test_data %>%
select(PassengerId),
Survived = predictions
)
submission
write.csv(
submission,
"data/submission.csv",
row.names = FALSE
)
data_loader(
"titanic.zip",
"gender_submission.csv"
)
train_data %>% summarise()
train_data %>% summary
train_data_factorized %>% summary
knitr::opts_chunk$set(
echo = TRUE
)
library(tidyverse)
library(glmnet)
library(ggthemes)
library(caret)
library(pROC)
theme_set(
theme_tufte(
base_size = 32,
base_family = 'Atkinson Hyperlegible'
)
)
data_loader <- function(filename, dataset, path = "data/") {
path <- paste0(path, filename)
read.csv(
unz(
path,
dataset
)
)
}
train_data <- data_loader(
"titanic.zip",
"train.csv"
)
test_data <- data_loader(
"titanic.zip",
"test.csv"
)
train_data %>% str
factorize_data <- function(dataframe) {
dataframe %>%
select(-Name, -Ticket) %>%
mutate(
Pclass = as.factor(Pclass),
Sex = as.factor(Sex),
SibSp = as.factor(SibSp),
Parch = as.factor(Parch),
Cabin = as.factor(Cabin),
Embarked = as.factor(Embarked)
)
}
train_data_factorized <- factorize_data(dataframe = train_data)
test_data_factorized <- factorize_data(dataframe = test_data)
train_data_factorized %>% summary
fit_full <- glm(Survived ~ ., data = train_data_factorized)
fit_full %>% summary
fit_null <- glm(Survived ~ 1, data = train_data_factorized)
sel_stepwise <- step(
fit_full,
scope = c(fit_null, fit_full),
direction = "both",
k = log(dim(train_data_factorized)[1])
)
sel_stepwise
predictions <-
ifelse(
predict(
sel_stepwise,
newdata = test_data_factorized,
type = "response"
) > .3,
1,
0
)
submission <- data.frame(
PassengerId = test_data %>%
select(PassengerId),
Survived = predictions
)
submission
write.csv(
submission,
"data/submission.csv",
row.names = FALSE
)
data_loader(
"titanic.zip",
"gender_submission.csv"
)
knitr::opts_chunk$set(
echo = TRUE
)
library(tidyverse)
library(glmnet)
library(ggthemes)
library(caret)
library(pROC)
theme_set(
theme_tufte(
base_size = 32,
base_family = 'Atkinson Hyperlegible'
)
)
data_loader <- function(filename, dataset, path = "data/") {
path <- paste0(path, filename)
read.csv(
unz(
path,
dataset
)
)
}
train_data <- data_loader(
"titanic.zip",
"train.csv"
)
test_data <- data_loader(
"titanic.zip",
"test.csv"
)
train_data %>% str
factorize_data <- function(dataframe) {
dataframe %>%
select(-Name, -Ticket) %>%
mutate(
Pclass = as.factor(Pclass),
Sex = as.factor(Sex),
SibSp = as.factor(SibSp),
Parch = as.factor(Parch),
Cabin = as.factor(Cabin),
Embarked = as.factor(Embarked)
)
}
train_data_factorized <- factorize_data(dataframe = train_data)
test_data_factorized <- factorize_data(dataframe = test_data)
train_data_factorized %>% summary
fit_full <- glm(Survived ~ ., data = train_data_factorized)
fit_full %>% summary
fit_null <- glm(Survived ~ 1, data = train_data_factorized)
sel_stepwise <- step(
fit_full,
scope = c(fit_null, fit_full),
direction = "both",
k = log(dim(train_data_factorized)[1])
)
sel_stepwise
predictions <-
ifelse(
predict(
sel_stepwise,
newdata = test_data_factorized,
type = "response"
) > .5,
1,
0
)
submission <- data.frame(
PassengerId = test_data %>%
select(PassengerId),
Survived = predictions
)
write.csv(
submission,
"data/submission.csv",
row.names = FALSE
)
sel_stepwise %>% coefficients()
sel_stepwise %>% coefficients() %>% t
kableExtra::kable(
sel_stepwise %>% coefficients()
)
knitr::opts_chunk$set(
echo = TRUE
)
library(tidyverse)
library(glmnet)
library(ggthemes)
library(caret)
library(pROC)
theme_set(
theme_tufte(
base_size = 32,
base_family = 'Atkinson Hyperlegible'
)
)
data_loader <- function(filename, dataset, path = "data/") {
path <- paste0(path, filename)
read.csv(
unz(
path,
dataset
)
)
}
train_data <- data_loader(
"titanic.zip",
"train.csv"
)
test_data <- data_loader(
"titanic.zip",
"test.csv"
)
train_data %>% str
factorize_data <- function(dataframe) {
dataframe %>%
select(-Name, -Ticket) %>%
mutate(
Pclass = as.factor(Pclass),
Sex = as.factor(Sex),
SibSp = as.factor(SibSp),
Parch = as.factor(Parch),
Cabin = as.factor(Cabin),
Embarked = as.factor(Embarked)
)
}
train_data_factorized <- factorize_data(dataframe = train_data)
test_data_factorized <- factorize_data(dataframe = test_data)
train_data_factorized %>% summary
fit_full <- glm(Survived ~ ., data = train_data_factorized)
fit_full %>% summary
fit_null <- glm(Survived ~ 1, data = train_data_factorized, family = "binomial")
sel_stepwise <- step(
fit_full,
scope = c(fit_null, fit_full),
direction = "both",
k = log(dim(train_data_factorized)[1])
)
sel_stepwise
predictions <-
ifelse(
predict(
sel_stepwise,
newdata = test_data_factorized,
type = "response"
) > .5,
1,
0
)
submission <- data.frame(
PassengerId = test_data %>%
select(PassengerId),
Survived = predictions
)
write.csv(
submission,
"data/submission.csv",
row.names = FALSE
)
kableExtra::kable(
sel_stepwise %>% coefficients()
)
knitr::opts_chunk$set(
echo = TRUE
)
library(tidyverse)
library(glmnet)
library(ggthemes)
library(caret)
library(pROC)
theme_set(
theme_tufte(
base_size = 32,
base_family = 'Atkinson Hyperlegible'
)
)
data_loader <- function(filename, dataset, path = "data/") {
path <- paste0(path, filename)
read.csv(
unz(
path,
dataset
)
)
}
train_data <- data_loader(
"titanic.zip",
"train.csv"
)
test_data <- data_loader(
"titanic.zip",
"test.csv"
)
train_data %>% str
factorize_data <- function(dataframe) {
dataframe %>%
select(-Name, -Ticket) %>%
mutate(
Pclass = as.factor(Pclass),
Sex = as.factor(Sex),
SibSp = as.factor(SibSp),
Parch = as.factor(Parch),
Cabin = as.factor(Cabin),
Embarked = as.factor(Embarked)
)
}
train_data_factorized <- factorize_data(dataframe = train_data)
test_data_factorized <- factorize_data(dataframe = test_data)
train_data_factorized %>% summary
fit_full <- glm(
Survived ~ .,
data = train_data_factorized,
family = "binomial"
)
fit_full %>% summary
fit_null <- glm(
Survived ~ 1,
data = train_data_factorized,
family = "binomial"
)
sel_stepwise <- step(
fit_full,
scope = c(fit_null, fit_full),
direction = "both",
k = log(dim(train_data_factorized)[1])
)
sel_stepwise
predictions <-
ifelse(
predict(
sel_stepwise,
newdata = test_data_factorized,
type = "response"
) > .5,
1,
0
)
submission <- data.frame(
PassengerId = test_data %>%
select(PassengerId),
Survived = predictions
)
write.csv(
submission,
"data/submission.csv",
row.names = FALSE
)
kableExtra::kable(
sel_stepwise %>% coefficients()
)
knitr::opts_chunk$set(
echo = TRUE
)
library(tidyverse)
library(glmnet)
library(ggthemes)
library(caret)
library(pROC)
theme_set(
theme_tufte(
base_size = 32,
base_family = 'Atkinson Hyperlegible'
)
)
data_loader <- function(filename, dataset, path = "data/") {
path <- paste0(path, filename)
read.csv(
unz(
path,
dataset
)
)
}
train_data <- data_loader(
"titanic.zip",
"train.csv"
)
test_data <- data_loader(
"titanic.zip",
"test.csv"
)
train_data %>% str
factorize_data <- function(dataframe) {
dataframe %>%
select(-Name, -Ticket) %>%
mutate(
Pclass = as.factor(Pclass),
Sex = as.factor(Sex),
SibSp = as.factor(SibSp),
Parch = as.factor(Parch),
Cabin = as.factor(Cabin),
Embarked = as.factor(Embarked)
)
}
train_data_factorized <- factorize_data(dataframe = train_data)
test_data_factorized <- factorize_data(dataframe = test_data)
train_data_factorized %>% summary
fit_full <- glm(
Survived ~ .,
data = train_data_factorized,
family = "binomial"
)
fit_full %>% summary
fit_null <- glm(
Survived ~ 1,
data = train_data_factorized,
family = "binomial"
)
sel_stepwise <- step(
fit_full,
scope = c(fit_null, fit_full),
direction = "both",
k = log(dim(train_data_factorized)[1])
)
sel_stepwise
predictions <-
ifelse(
predict(
sel_stepwise,
newdata = test_data_factorized,
type = "response"
) > .5,
1,
0
)
submission <- data.frame(
PassengerId = test_data %>%
select(PassengerId),
Survived = predictions
)
write.csv(
submission,
"data/submission.csv",
row.names = FALSE
)
kableExtra::kable(
sel_stepwise %>% coefficients()
)
dim(train_data_factorized)[1]
knitr::opts_chunk$set(
echo = TRUE
)
library(tidyverse)
library(glmnet)
library(ggthemes)
theme_set(
theme_tufte(
base_size = 12,
base_family = 'Atkinson Hyperlegible'
)
)
sel_stepwise %>% coefficients()
coefficients(sel_stepwise)[5]
coefficients(sel_stepwise)[4]
coefficients(sel_stepwise)$Sexmale
convert_to_prob <- function(logit) {
exp(logit)/(1+exp(logit))
}
sel_stepwise %>% coefficients() %>%  convert_to_prob()
